<!DOCTYPE html>
<html>
<head>
  <title>정확한 시간 기준 예약 접속</title>
</head>
<body>
  <h2>서버 기준 시간으로 예약된 링크 열기</h2>
  <label>URL: <input type="text" id="url" placeholder="https://example.com"></label><br><br>
  <label>시간: <input type="time" id="time"></label><br><br>
  <button onclick="schedule()">예약</button>

  <script>
    async function schedule() {
      const url = document.getElementById('url').value;
      const time = document.getElementById('time').value;
      if (!url || !time) return alert("URL과 시간을 모두 입력하세요");

      // 서버 시간 가져오기
      const res = await fetch("https://worldtimeapi.org/api/timezone/Asia/Seoul");
      const data = await res.json();
      const serverNow = new Date(data.datetime);

      const [hh, mm] = time.split(":").map(Number);
      const target = new Date(serverNow.getFullYear(), serverNow.getMonth(), serverNow.getDate(), hh, mm, 0, 0);

      const delay = target - serverNow;

      if (delay <= 0) {
        alert("미래 시간을 선택하세요");
        return;
      }

      alert(`예약 완료! ${Math.floor(delay / 1000)}초 후에 접속합니다.`);
      setTimeout(() => {
        window.open(url, "_blank");
      }, delay);
    }
  </script>
</body>
</html>
